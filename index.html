<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>zeroOS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="https://i.imgur.com/126nI80.png">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@300..800&display=swap');

/* RESET */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Segoe UI", "Open Sans", sans-serif;
  user-select: none;
}

html, body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  background-color: #1a1a1a;
  cursor: url(https://i.imgur.com/RKEw5i6.png), default!important;
}

/* ===================== DESKTOP ===================== */
#desktop {
  width: 100%;
  height: 100%;
  background: url("https://glacier.webmc.xyz/windows/wallpaper1.webp") center/cover no-repeat;
  position: relative;

  display: flex;
  flex-wrap: wrap;        
  align-content: flex-start; 
  gap: 20px;

  padding: 20px;
  box-sizing: border-box;
}


/* =====================
 TASKBAR
  ===================== */
#taskbar {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 60px;
  background: rgba(20, 20, 20, 0.75);
  backdrop-filter: blur(20px);
  display: flex;
  align-items: center;
  justify-content: space-between; 
  z-index: 100;
  padding: 0 15px; 
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}  

#taskbar-inner {
  display: flex;
  gap: 14px;
  cursor: url(https://i.imgur.com/RKEw5i6.png), default!important;
}

.cloak-btn {
  width: 180px;
  height: 40px;
  border-radius: 6px;
  background: rgba(255,255,255,0.15);
  display: flex;
  align-items: center;
  text-align: center;
  justify-content: center;
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  transition: background 0.2s;
  font-weight: bold;
}

.cloak-btn:hover {
  background: rgba(255,255,255,0.35);
}

.taskbar-icon {
  width: 46px;
  height: 46px;
  /* used to be 36 */
  border-radius: 6px;
  /* background: rgba(255,255,255,0.15); */
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  transition: background 0.2s;
}

.taskbar-icon img {
  /* used to be 26 */
  width: 34px;
  height: 34px;
}

.taskbar-icon:hover {
  background: rgba(255,255,255,0.35);
}

/* ===================== START MENU ===================== */
#start-menu {
  position: absolute;
  bottom: 60px;
  left: 50%;
  transform: translateX(-50%);
  width: 420px;
  height: 520px;
  background: rgba(30,30,30,0.85);
  backdrop-filter: blur(25px);
  border-radius: 12px;
  padding: 20px;
  display: none;
  color: white;
  z-index: 90;
  transition: 0.3s all ease;
}

/* ===================== WINDOWS ===================== */
.window {
  position: absolute;
  width: 800px;
  height: 500px;
  background: #111;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 20px 50px rgba(0,0,0,0.6);
  transform: scale(0.3);
  opacity: 0;
  transition: transform 0.18s ease, opacity 0.18s ease;
}

.window.open {
  transform: scale(1);
  opacity: 1;
}

.window.closing {
  transform: scale(0.3);
  opacity: 0;
}

.title-bar {
  height: 36px;
  background: rgba(255,255,255,0.05);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 10px;
  color: white;
}

.maximize-button {
  margin-left: auto;
  margin-right: 10px;
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  size: 12px;
}

.maximize-button img {
    max-width: 50%; 
    height: 20px;   
    width: 40px;     
    display: block; 
    margin: auto;    
}

.window-content {
  width: 100%;
  height: calc(100% - 36px);
}
    
    .window-content embed {
  width: 100%;
  height: calc(100% - 36px);
}


/* ===================== STORE ===================== */
.store {
  display: flex;
  height: 100%;
  color: white;
  transition: 0.2s all ease;
}

/* Sidebar (icons only) */
.store-sidebar {
  width: 60px;
  background: rgba(255,255,255,0.05);
  padding: 10px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: center;
}

.store-sidebar button {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  background: rgba(255,255,255,0.15);
  border: none;
  font-size: 22px;
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  color: white;
  transition: background 0.2s;
}

.store-sidebar button:hover,
.store-sidebar button.active {
  background: rgba(255,255,255,0.35);
}

/* Store content area */
.store-content {
  flex: 1;
  padding: 16px;
  overflow-y: scroll;
}

#store-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, 180px);
  gap: 16px;
  justify-content: start;
  align-items: start;
}

/* Apps/games/devtools from the store ü§ì */
.store-item {
  /* aspect-ratio: 9 / 9; */
  width: 60%;
  max-width: 220px;
  height: 130px;

  background: rgba(255,255,255,0.12);
  border-radius: 12px;
  padding: 12px;

  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  justify-content: center;

  position: relative;
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  transition: background 0.2s;
  font-size: 12px;
}

.store-item:hover {
  background: rgba(255,255,255,0.35);
}

.store-item img {
  width: 64px;
  height: 64px;
  /* was 48px */
  margin-bottom: 8px;
}

.pin-button {
  position: absolute;
  top: 6px;
  right: 6px;
  width: 22px;
  height: 22px;
  border-radius: 8px;
  background: rgba(33, 155, 12, 0.98);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  transition: all 0.2s;
}

.pin-button.pinned {
  background: red;
}

.pin-button:hover {
  background: rgba(13, 136, 52, 0.99);
}

.desktop-icon {
  width: 72px;          
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;

  color: white;
  font-size: 12px;
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  text-align: center;
}


.desktop-icon img {
  width: 48px;
  height: 48px;
  object-fit: contain;
}

.overlay {
    display: none; 
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: 1000;
    /* justify-content: center; */
    align-items: center;
}
.popup-box {
    position: absolute;
    top: 0;
    right: 0;
    background: #333;
    padding: 30px;
    border-radius: 12px; 
    /* position: relative; */
    max-width: 400px;
    height: 200px;
    color: white;
    border: 2px solid #0078D4; 
    box-shadow: 0 0 15px rgba(0, 120, 212, 0.6);
}
.close-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    border: none;
    background: none;
    font-size: 24px;
    cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
    color: white; 
}
.checkbox-container {
    margin-top: 20px;
    font-size: 14px;
    cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
}
.checkbox-container:hover {
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
}

#system-tray {
  display: flex;
  align-items: center;
  color: white;
  min-width: 120px; 
  width: auto;
  justify-content: flex-end;
  cursor: url(https://i.imgur.com/RKEw5i6.png), default!important;
}

#clock-container {
  text-align: right;
  padding: 6px 10px;
  border-radius: 8px;
  transition: background 0.2s;
}

#clock-container:hover {
  background: rgba(255, 255, 255, 0.15);
}

#taskbar-time {
  font-size: 15px;
  font-weight: 600;
  letter-spacing: 0.5px;
  margin-right: 15px;
}

#taskbar-date {
  font-size: 12px;
  opacity: 0.85;
  margin-top: 1px;
  margin-right: 15px;
}

.factory-btn {
  background: #222;
  border: 2px solid #d93025;
  color:white; 
  padding:10px 20px; 
  border-radius:5px; 
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important; 
  font-weight:bold;
  transition: 0.2s all ease;
}

.factory-btn:hover {
  background: #d93025; 
}

#info-popup::after {
    content: "";
    position: absolute;
    top: 100%;
    right: 5px;
    border-width: 5px;
    border-style: solid;
    border-color: #0078D4 transparent transparent transparent;
}
/* "nobody CARES ABOUT THIS CHATTYICEEEE"- caramel213*/

/* .settingscloak-btn {
  width: 100%; 
  margin-bottom: 12px; 
  background: #222
  border: 2px solid rgba(0, 120, 212, 0.3);
}

.settingscloak-btn:hover {
    background: rgba(0, 120, 212, 0.3);
} */

.settingscloak-btn {
  width: 100%; 
  margin-bottom: 12px; 
  height: 40px;
  border-radius: 6px;
  border: 2px solid rgba(0, 120, 212, 0.3);
  display: flex;
  align-items: center;
  text-align: center;
  justify-content: center;
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  transition: all 0.2s ease;
  font-weight: bold;
}

.settingscloak-btn:hover {
    background-color: rgba(0, 120, 212, 0.3);
}

.settings-section {
    background: transparent;
    transition: none;
    transition: none !important;
    border-radius: 5px;

    height: 30px !important;
}

.settings-section:hover {
    background: #555 !important;
    transition: none !important;
    cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  }

.settings-section.active {
    background: #555 !important;
    transition: none !important;
}


.settingscloak-btn2 {
  width: 100%; 
  margin-bottom: 12px; 
  height: 40px;
  border-radius: 6px;
  border: 2px solid rgba(255,255,255,0.1);
  display: flex;
  align-items: center;
  text-align: center;
  justify-content: center;
  cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;
  transition: all 0.2s ease;
  font-weight: bold;
}

.settingscloak-btn2:hover {
  background: rgba(255, 255, 255, 0.1);
}

.site-notification {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 300px;
    background: #222; /* Dark gray */
    color: white;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    z-index: 9999;
    font-family: sans-serif;
    display: none; /* Hidden by default, JS will show it */
}

.site-notification h4 {
    margin: 0 0 10px 0;
    font-size: 16px;
}

.site-notification p {
    margin: 0 0 15px 0;
    font-size: 13px;
    line-height: 1.4;
    color: #ccc;
}

.notif-close {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;    font-weight: bold;
    color: #888;
}

.notif-close:hover { color: white; }

.notif-options {
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 5px;
    border-top: 1px solid #444;
    padding-top: 10px;
}


  </style>
</head>
<body oncontextmenu="return false;">
<div id="welcome-notif" class="site-notification">
    <span class="notif-close" onclick="closeNotif()">‚úï</span>
    <h4>Welcome to zeroOS!</h4>
    <p>Hope you enjoy your stay! For best usage, I recommend zooming the site to 80% by pressing ctrl + - twice. Let me know if you find any bugs, check out the settings, disguise the tab, and have fun!</p>
    <div class="notif-options">
        <input type="checkbox" id="dont-show-checkbox">
        <label for="dont-show-checkbox">Do not show me again</label>
    </div>
</div>


  <div id="desktop">
    <!-- TASKBAR -->
    <div id="taskbar">
      <div style="width: 120px;"></div>
      <div id="taskbar-inner">
        <!-- Start Menu  -->
        <div class="taskbar-icon" onclick="toggleStart()">
          <img src="https://preview.redd.it/sudz5o3s1vn91.png?width=1080&format=png&auto=webp&s=27107d9d26f3b82ee00f53becd873b7bef881744" alt="Start" />
        </div>
        <!-- setting the set settings ‚öô -->
        <div class="taskbar-icon" onclick="openSettings()">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ac/Windows_Settings_icon.svg/960px-Windows_Settings_icon.svg.png" alt="settings">
        </div>
        <!-- browser -->
        <div class="taskbar-icon" onclick="openApp('Browser', 'https://redtide-stack.github.io/zeroOS-assets/p.html')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/7/7e/Microsoft_Edge_logo_%282019%29.png" alt="Edge" />
        </div>
        <!-- chat -->
         <div class="taskbar-icon" onclick="openApp('Chatroom', 'https://redtide-stack.github.io/zeroOS-assets/chat.html')">
          <img src="https://static.vecteezy.com/system/resources/thumbnails/008/508/754/small/3d-chat-mail-message-notification-chatting-illustration-png.png" alt="chatroom">
        </div>
        <!-- help me twin -->
        <div class="taskbar-icon" onclick="openApp('Help', 'https://redtide-stack.github.io/zeroOS-assets/help.html')">
          <img src="https://i.imgur.com/wP962mX.png" alt="Help">
        </div>
        <!-- promptpad totally not stolen from selenite and glacier -->
        <div class="taskbar-icon" onclick="openApp('Promptpad', 'https://selenitebyplayer.artmuseum.org/resources/sppa/code/index.html')">
          <img src="https://i.imgur.com/GnJAVTq.png" alt="Notepad" />
        </div>
        <!-- calc -->
        <div class="taskbar-icon" onclick="openApp('Calculator', 'https://desmos.com/scientific')">
          <img src="https://i.imgur.com/pwVPAKD.png">
        </div>
        <!-- camara üò¢ -->
        <div class="taskbar-icon" onclick="openApp('Camera', 'https://redtide-stack.github.io/zeroOS-assets/camera.html')">
          <img src="https://i.imgur.com/fV1Tu3S.png">
        </div>
        <!-- Megahard store :) -->
        <div id="taskbar-store-btn" class="taskbar-icon">
          <img src="https://upload.wikimedia.org/wikipedia/commons/a/a7/Microsoft_Store_Fluent_Design_icon_Windows_11.png" alt="Microsoft Store" />
        </div>
      </div>
      <div id="system-tray">
      <div id="clock-container">
        <div id="taskbar-time">12:00 PM</div>
        <div id="taskbar-date">1/1/2024</div>
    </div>
    </div>
    </div>

    <!-- START MENU name is mr fah-->
    <div id="start-menu">
      <h3>Pinned Apps</h3>
      <br>
      <div onclick="openStore()" class="taskbar-icon">
        <img src="https://upload.wikimedia.org/wikipedia/commons/a/a7/Microsoft_Store_Fluent_Design_icon_Windows_11.png" alt="Microsoft Store" />
      </div>
        <input id="blockTabToggle" style="display: none;"> <!-- I HATE EVENT LISTENERS I CANT GET RID OF THIS SHIT W/OUT BREAKING THE SITE-->
    </div>
  </div>
  <script>
    window.addEventListener('load', function() {
    const notif = document.getElementById('welcome-notif');
    const checkbox = document.getElementById('dont-show-checkbox');
    
    if (localStorage.getItem('hideNotification') !== 'true') {
        notif.style.display = 'block';
    }

    window.closeNotif = function() {
        if (checkbox.checked) {
            localStorage.setItem('hideNotification', 'true');
        }
        notif.style.display = 'none';
    };
});


function updateClock() {
    const now = new Date();
    
    const timeStr = now.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });
    
    const dateStr = (now.getMonth() + 1) + '/' + now.getDate() + '/' + now.getFullYear();

    document.getElementById('taskbar-time').textContent = timeStr;
    document.getElementById('taskbar-date').textContent = dateStr;
}

setInterval(updateClock, 1000);
updateClock(); 


let blockTabEnabled = false; 

    document.getElementById('blockTabToggle').addEventListener('change', function () {
    blockTabEnabled = this.checked;
});

window.addEventListener('beforeunload', function (event) {
    if (blockTabEnabled) {
        event.preventDefault();
        event.returnValue = 'Are you sure you want to leave?';
    }
}); 
    
    const pinnedApps = JSON.parse(localStorage.getItem("zeroos_pinned_apps")) || [];

    function renderPinnedApps() {
  const desktop = document.getElementById("desktop");

  pinnedApps.forEach(app => {
    if (document.querySelector(`[data-app="${app.name}"]`)) return;

    const icon = document.createElement("div");
    icon.className = "desktop-icon";
    icon.dataset.app = app.name;

    icon.innerHTML = `
      <img src="${app.image}">
      <span>${app.name}</span>
    `;

    icon.onclick = () => openApp(app.name, app.url);
    desktop.appendChild(icon);
  });
}

        
/* ============================
   GLOBAL STATE
   ============================ */

let z = 10;
const openWindows = {};
/* ============================
   START MENU
   ============================ */

function toggleStart() {
  const menu = document.getElementById("start-menu");
  menu.style.display = menu.style.display === "block" ? "none" : "block";
}

const element = document.getElementById('start-menu');




const keyframes = [
  { transform: 'translateX(0px)', opacity: 1 }, 
  { transform: 'translateX(100px)', opacity: 0.5 } 
];

/* ============================
   WINDOW DRAGGING
   ============================ */

let dragData = null;

document.addEventListener("mousemove", e => {
  if (!dragData) return;

  dragData.win.style.left = e.clientX - dragData.offsetX + "px";
  dragData.win.style.top = e.clientY - dragData.offsetY + "px";
});

document.addEventListener("mouseup", () => {
  dragData = null;
});

function makeWindowDraggable(win) {
  const titleBar = win.querySelector(".title-bar");
  if (!titleBar) return;

  titleBar.addEventListener("mousedown", e => {
    // ‚ùå don't drag if maximized
    if (win.dataset.maximized === "true") return;

    // ‚ùå ignore buttons
    if (e.target.closest(".maximize-button")) return;
    if (e.target.textContent === "‚úï") return;

    win.style.zIndex = z++;

    const rect = win.getBoundingClientRect();
    dragData = {
      win,
      offsetX: e.clientX - rect.left,
      offsetY: e.clientY - rect.top
    };
  });
}

/* ============================
   WINDOW MANAGEMENT
   ============================ */

function openApp(title, url) {
  if (openWindows[title]) {
    closeWindow(openWindows[title], title);
    return;
  }

  const win = document.createElement("div");
  win.className = "window";
  win.dataset.maximized = "false";
  win.style.top = "100px";
  win.style.left = "100px";
  win.style.zIndex = z++;

  win.innerHTML = `
    <div class="title-bar">
      <span>${title}</span>
      <div class="maximize-button" onclick="toggleMaximize('${title}')"><img src="https://i.imgur.com/iigug37.png"></div>
      <div style="cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;" onclick="closeWindow(this.parentElement.parentElement,'${title}')">‚úï</div>
    </div>
    <div class="window-content">
      <embed src="${url}">
    </div>
  `;

  document.getElementById("desktop").appendChild(win);
  openWindows[title] = win;

  makeWindowDraggable(win);

  win.offsetHeight;
  win.classList.add("open");
}

function closeWindow(win, title) {
  win.classList.remove("open");
  win.classList.add("closing");

  setTimeout(() => {
    win.remove();
    delete openWindows[title];
  }, 180);
}

function toggleMaximize(title) {
  const win = openWindows[title];
  if (!win) return;

  const maximized = win.dataset.maximized === "true";

  if (maximized) {
    win.style.top = "100px";
    win.style.left = "100px";
    win.style.width = "800px";
    win.style.height = "500px";
    win.dataset.maximized = "false";
  } else {
    win.style.top = "0";
    win.style.left = "0";
    win.style.width = "100%";
    win.style.height = "100%";
    win.dataset.maximized = "true";
  }
}

/* ============================
   SETTINGS
   ============================ */

function openSettings() {
    if (openWindows["Settings"]) {
        openWindows["Settings"].style.zIndex = z++;
        return;
    }

    const win = document.createElement("div");
    win.className = "window";
    win.dataset.maximized = "false";
    win.style.top = "50px";
    win.style.left = "150px";
    win.style.zIndex = z++;

    win.innerHTML = `
        <div class="title-bar">
            <span>Settings</span>
            <div class="maximize-button" onclick="toggleMaximize('Settings')"><img src="https://i.imgur.com/iigug37.png"></div>
            <div style="cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;" onclick="closeWindow(this.parentElement.parentElement,'Settings')">‚úï</div>
        </div>
        <div class="window-content store">
            <div class="store-sidebar" style="width: 180px; align-items: flex-start; padding: 15px;">
                <button class="settings-section" onclick="loadSettings('personalization', this)" style="width:100%; text-align:left; font-size:13px; margin-bottom:5px; padding-left: 10px; border-radius: 7px; background: transparent;"><img src="https://i.imgur.com/BWqzkjw.png" style="width: 15px; height: 15px;"> Personalization</button>
                <button class="settings-section" onclick="loadSettings('cloaking', this)" style="width:100%; text-align:left; font-size:13px; margin-bottom:5px; padding-left: 10px; display: flex; align-items: center; border-radius: 7px; background: transparent;"><img src="https://i.imgur.com/RV5FuEQ.png" style="width: 25px; height: 25px; margin-right: 10px;">Cloaking</button>
                <button class="settings-section" onclick="loadSettings('system', this)" style="width:100%; text-align:left; font-size:13px; margin-bottom:5px; padding-left: 10px; display: flex; align-items: center; border-radius: 7px; background: transparent;"><img src="https://i.imgur.com/G8vPg73.png" style="width: 15px; height: 15px; margin-right: 7px;">     System</button>
            </div>
            <div class="store-content" id="settings-content" style="padding:20px;"></div>
        </div>
    `;

    document.getElementById("desktop").appendChild(win);
    openWindows["Settings"] = win;
    makeWindowDraggable(win);
    win.classList.add("open");
    loadSettings('personalization', win.querySelector('.store-sidebar button'));
}


function loadSettings(type, btn) {
    const content = document.getElementById("settings-content");
    document.querySelectorAll(".store-sidebar button").forEach(b => b.classList.remove("active"));
    if (btn) btn.classList.add("active");
 if (type === 'personalization') {
    const desktop = document.getElementById('desktop');
    const taskbar = document.getElementById('taskbar');
    
    const bgMatch = desktop.style.backgroundImage.match(/url\(["']?([^"']*)["']?\)/);
    const currentBg = bgMatch ? bgMatch[1] : "https://glacier.webmc.xyz/windows/wallpaper1.webp"; //yo phone linging
    const currentBlur = taskbar.style.backdropFilter.replace(/[^0-9]/g, '') || 20;
    const isFloating = taskbar.style.width === "auto" || taskbar.style.width === "max-content";
                            // url stands for unicorn real label btw 
    content.innerHTML = `
        <h2 style="color:white;">Personalization <ion-icon name="brush-outline"></ion-icon></h2>
        <p style="color:gray; font-size:13px; margin-bottom:15px;">Customize Zero to your liking.</p>
        <hr style="border:0; border-top:1px solid #444; margin:20px 0;">
        <h3>Wallpaper</h3>
        <p style="color:gray; font-size:13px;">Wallpaper URL:</p> 
        <input type="text" id="set-bg-url" value="${currentBg}" style="width:80%; padding:8px; background:#222; color:white; border:1px solid #444; border-radius:5px;">
        <button id="apply-bg-btn" style="display:block; margin-top:10px; padding:8px 15px; cursor: url(https://i.imgur.com/IHgioev.png), pointer!important; background:#0078D4; color:white; border:none; border-radius:4px;">Apply Wallpaper</button>
        
        <hr style="border:0; border-top:1px solid #444; margin:20px 0;">

        <label style="color:white; display:block; margin-bottom:8px;">Taskbar Blur (${currentBlur}px)</label>
        <input type="range" min="0" max="30" value="${currentBlur}" id="blur-slider" style="width:100%;">
        
        <br><br>

        <label style="color:white; display:block; margin-bottom:10px;">Taskbar Color</label>
        <input type="color" id="taskbar-color-picker" value="#ffffff" style="width:20%; height:40px; border:none; background:none; cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;">
        
        <br><br>
        
        <label style="display:flex; align-items:center; gap:12px; cursor: url(https://i.imgur.com/IHgioev.png), pointer!important; color:white;">
            <input type="checkbox" id="float-checkbox" ${isFloating ? 'checked' : ''}>
            <span>Floating taskbar (MacOS style)</span>
        </label>
    `;

    // --- "getelementbymyass" -caramel213 (again)---

    document.getElementById('apply-bg-btn').onclick = function() {
        const url = document.getElementById('set-bg-url').value;
        desktop.style.backgroundImage = `url('${url}')`;
    };

    document.getElementById('blur-slider').oninput = function() {
        taskbar.style.backdropFilter = `blur(${this.value}px)`;
        this.previousElementSibling.innerText = `Taskbar Blur (${this.value}px)`;
    };

    document.getElementById('taskbar-color-picker').oninput = function() {
        const hex = this.value;
        const r = parseInt(hex.slice(1, 3), 16), g = parseInt(hex.slice(3, 5), 16), b = parseInt(hex.slice(5, 7), 16);
        taskbar.style.background = `rgba(${r}, ${g}, ${b}, 0.75)`;
    };

    document.getElementById('float-checkbox').onchange = function() {
        if (this.checked) {
            taskbar.style.width = "max-content";
            taskbar.style.minWidth = "600px";
            taskbar.style.bottom = "15px";
            taskbar.style.left = "50%";
            taskbar.style.transform = "translateX(-50%)";
            taskbar.style.borderRadius = "20px";
            taskbar.style.padding = "0 20px";
            taskbar.style.border = "1px solid rgba(255,255,255,0.1)";
        } else {
            taskbar.style.width = "100%";
            taskbar.style.minWidth = "none";
            taskbar.style.bottom = "0";
            taskbar.style.left = "0";
            taskbar.style.transform = "none";
            taskbar.style.borderRadius = "0";
            taskbar.style.padding = "0 15px";
            taskbar.style.border = "none";
        }
    };
}

    else if (type === 'cloaking') {
    content.innerHTML = `
        <h2 style="color:white;">Cloaking  <ion-icon name="shield-checkmark-outline"></ion-icon></h2><br>
        <p style="color:gray; font-size:13px; margin-bottom:15px;">Use these tools to disguise your tab as Finite Campus, prevent teachers from seeing your screen on NoGuardian, and block tab from being closed (more info at the setting).</p>
        
        <div onclick="AboutBlank()" class="settingscloak-btn">
            Launch about:blank Cloak <ion-icon name="open-outline" style="margin-left: 8px; vertical-align: middle;"></ion-icon>
        </div>
        
        <div class="settingscloak-btn2" onclick="tabCloak()">
            Infinite Campus Tab Cloak <ion-icon name="pencil-outline" style="margin-left: 8px; vertical-align: middle;"></ion-icon>
        </div>
        
        <hr style="border:0; border-top:1px solid #444; margin: 20px 0;">
        
        <label style="display:flex; align-items:center; gap:12px; color:white; font-size:14px; position:relative;">
            <input type="checkbox" id="blockTabToggleSettings" 
                   ${blockTabEnabled ? 'checked' : ''} 
                   onchange="blockTabEnabled = this.checked;">
            <span>Prevent tab from being closed (Anti-Close)</span>
            
            <!-- Info Icon & Popup -->
            <div class="info-wrapper" style="position:relative; display:inline-block;">
                <span onclick="toggleInfo(event)" style="cursor: url(https://i.imgur.com/IHgioev.png), pointer!important; opacity:0.6; font-size:18px;">&#x1F6C8;</span>
                <div id="info-popup" style="display:none; position:absolute; bottom:30px; right:0; width:250px; background:#333; border:1px solid #0078D4; padding:10px; border-radius:8px; font-size:12px; z-index:100; box-shadow:0 4px 15px rgba(0,0,0,0.5);">
                    <strong>How to use:</strong><br>
                    This stops your teachers from closing your tab remotely, or when teacher mode is on (all sites blocked except teacher-selected sites), go on the teacher block page, spam alt+d+enter until everything is really laggy and tabs only show the icon, open zeroOS, turn this setting on ASAP, and as the popups come in to close the tab, always cancel and after a while NoGuardian gives up. You can then browse and play freely!
                </div>
            </div>
        </label>
    `;
}

    else if (type === 'system') {
        content.innerHTML = `
            <h2 style="color:white;">System   <ion-icon name="laptop-outline"></ion-icon></h2><br>
            <div style="background:rgba(255,255,255,0.05); padding:15px; border-radius:10px;">
                <p style="color:white;"><strong>OS Name:</strong> zeroOS</p>
                <p style="color:gray; font-size:13px;">Build: 1.0.8-beta</p>
                <p style="color:gray; font-size:13px;">Status: Operational</p>
            </div>
            <br>
            <button onclick="if(confirm('Reset all settings and pinned apps?')){localStorage.clear(); location.reload();}" 
                    class="factory-btn">
                Factory Reset zeroOS
            </button>
        `;
    }
    else if (type === 'display') { // "display my ahh" - _bingonighttonight
    const taskbar = document.getElementById('taskbar');
    const currentBlur = taskbar.style.backdropFilter.replace(/[^0-9.]/g, '') || 20;

    content.innerHTML = `
        <h2>Display Settings</h2><br>
        <p style="color:gray;">Customize how your taskbar and windows look.</p><br>
        
        <div style="background:rgba(255,255,255,0.05); padding:20px; border-radius:10px;">
            <label style="display:block; margin-bottom:10px; color:white;">Taskbar Blur (${currentBlur}px)</label>
            <input type="range" min="0" max="30" value="${currentBlur}" id="blur-slider" style="width:100%;">
            
            <br><br>
            
            <label style="display:block; margin-bottom:10px; color:white;">Taskbar Color</label>
            <input type="color" id="taskbar-color" value="#141414" style="width:20%; height:40px; border:none; background:none; cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;">
            
            <br><br>
            
            <label style="display:flex; align-items:center; gap:10px; cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;">
                <input type="checkbox" id="taskbar-floating" ${taskbar.style.width === '95%' ? 'checked' : ''}>
                <span>Floating Taskbar Mode</span>
            </label>
        </div>
    `;

    document.getElementById('blur-slider').addEventListener('input', function() {
        taskbar.style.backdropFilter = `blur(${this.value}px)`;
        this.previousElementSibling.innerText = `Taskbar Blur (${this.value}px)`;
    });

    document.getElementById('taskbar-color').addEventListener('input', function() {
        const hex = this.value;
        const r = parseInt(hex.slice(1, 3), 16);
        const g = parseInt(hex.slice(3, 5), 16);
        const b = parseInt(hex.slice(5, 7), 16);
        taskbar.style.background = `rgba(${r}, ${g}, ${b}, 0.75)`;
    });

document.getElementById('taskbar-floating').addEventListener('change', function() {
    const taskbar = document.getElementById('taskbar');
    if (this.checked) {
        taskbar.style.width = "max-content"; 
        taskbar.style.minWidth = "200px";   
        taskbar.style.padding = "0 20px";   
        taskbar.style.bottom = "15px";      
        taskbar.style.left = "50%";       
        taskbar.style.transform = "translateX(-50%)"; 
        taskbar.style.borderRadius = "20px"; 
        taskbar.style.border = "1px solid rgba(255,255,255,0.1)";
    } else {
        taskbar.style.width = "100%";
        taskbar.style.minWidth = "none";
        taskbar.style.padding = "0";
        taskbar.style.bottom = "0";
        taskbar.style.left = "0";
        taskbar.style.transform = "none";
        taskbar.style.borderRadius = "0";
        taskbar.style.border = "none";
    }
});

}

}

function toggleInfo(event) {
    event.preventDefault();
    event.stopPropagation(); 
    const popup = document.getElementById('info-popup');
    if (popup.style.display === 'none') {
        popup.style.display = 'block';
    } else {
        popup.style.display = 'none';
    }
}

document.addEventListener('mousedown', (e) => {
    const popup = document.getElementById('info-popup');
    if (popup && !e.target.closest('.info-wrapper')) {
        popup.style.display = 'none';
    }
});



/* ============================
   MICROSOFT STORE
   ============================ */

function openStore() {
  if (openWindows["Store"]) return;

  const win = document.createElement("div");
  win.className = "window";
  win.dataset.maximized = "false";
  win.style.top = "80px";
  win.style.left = "120px";
  win.style.zIndex = z++;

  //    <div class="maximize-button" onclick="toggleMaximize('Store')"><img src="assets/maximize.webp"></div> pluh

 win.innerHTML = `
    <div class="title-bar">
      <span>Microsoft Store</span>
      <div class="maximize-button" onclick="toggleMaximize('Store')"><img src="https://i.imgur.com/iigug37.png"></div>
      <div style="cursor: url(https://i.imgur.com/IHgioev.png), pointer!important;" onclick="closeWindow(this.parentElement.parentElement,'Store')">‚úï</div>
    </div>
    <div class="window-content store">
      <div class="store-sidebar">
        <button onclick="loadStore('games', this)">
          <img src="https://i.imgur.com/NYN9NZt.png" alt="Games" style="width:20px;">
        </button>
        <button onclick="loadStore('apps', this)">
          <img src="https://i.imgur.com/nS51nGU.png" alt="Apps" style="width:20px;">
        </button>
        <button onclick="loadStore('dev', this)">
          <img src="https://i.imgur.com/XYZdDUP.png" alt="Dev" style="width:20px;">
        </button>
      </div>
      <div class="store-content">
        <div id="store-grid"></div>
      </div>
    </div>
  `;


  document.getElementById("desktop").appendChild(win);
  openWindows["Store"] = win;

  makeWindowDraggable(win);
  win.classList.add("open");

  loadStore("games");
}



function loadStore(type, btn) {
  document.querySelectorAll(".store-sidebar button")
    .forEach(b => b.classList.remove("active"));
  if (btn) btn.classList.add("active");

  const grid = document.getElementById("store-grid");
  grid.innerHTML = "";

  const storeApps = {
    games: [
      { name: "All Games", url: "https://redtide-stack.github.io/zeroOS-assets/moregames.html", image: "https://lh3.googleusercontent.com/Mxl8996vzcWWRU5RyKdTDA76GEPj9jQpuYc02nPgtwKgdqpWidM5YVqu8DHBd-D1sZ3sP1AOYB-DlNhMEpaLJxQcTQ=s128-rj-sc0x00ffffff" },
      { name: "PolyTrack", url: "https://gaming-escape.github.io/public/assets/games/poly-track/index.html", image: "https://geometrydashlite2.io/data/image/game/polytrack/polytrack.png" },
      { name: "Roblox Player", url: "https://nowgg.fun/apps/a/19900/b.html", image: "https://upload.wikimedia.org/wikipedia/commons/7/7e/Roblox_Logo_2022.jpg" },
      { name: "Duck Life 3", url: "https://selenitebyplayer.artmuseum.org/resources/semag/ducklife3/index.html", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT3em2qQpj_DxFl1HeNIZn8B-8mujTR59SFHQ&s" },
      { name: "Escape Road", url: "https://redtide-stack.github.io/zeroOS-assets/escroad.html", image: "https://escaperoad.io/cache/data/image/game/escape-road-game-sr1-f240x240.webp" },
      { name: "Minecraft Launcher", url: "https://eaglercraft.com/play", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQHDDzMFbYR5tfpoSCpqt_iltsGj5kzFTX5ew&s" },
      { name: "Crazy Cattle 3D", url: "https://zxsgames.vip/g/crazycattle.html", image: "https://img.itch.zone/aW1nLzIwNzkwNDg0LnBuZw==/315x250%23c/O5flR4.png" },
      { name: "Geometry Dash Lite", url: "https://script.google.com/a/macros/ogsd.net/s/AKfycbydNb9Y8FIM3D0vcweKtYCYbjJcSXghedO6MN0aWbP5qIwamjjSkBDirvuMHR_6sc4/exec", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTBms9b8YIAtSUbezumxG-dUppHEplVXpAlnA&s", },
      { name: "Crossy Road", url: "https://cantblockthis.neocities.org/", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTQR2Yhu6Qcf7NRF_jlPRlkmjIq5KhX0variQ&s", },
      { name: "Vex 6", url: "https://1kh0.github.io/projects/vex6/index.html", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRWGZ2hTJsSTm1l1ur5lAXSchV4_wpuBKXQTQ&s", },
      { name: "Slope", url: "https://3kh0.github.io/projects/slope/", image: "https://slopegame-online.com/slope.webp", },
      { name: "Tetris", url: "https://1kh0.github.io/projects/flashtetris/index.html", image: "https://tetris.com/_next/image?url=https%3A%2F%2Fwww.datocms-assets.com%2F145957%2F1744295598-tetris-firetv-appicon-728x728_728x728.png&w=2048&q=75", },
      { name: "Worlds Hardest Game", url: "https://1kh0.github.io/projects/worlds-hardest-game/index.html", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSAitjWxCWZeKzNg5wO6HLWJyKg5X34WClFKQ&s", },
      { name: "Ultrakill", url: "https://redtide-stack.github.io/zeroOS-assets/ultrakill.html", image: "https://assets-prd.ignimgs.com/2022/04/08/ultrakill-1649459578320.jpg" },
      { name: "Stickman and Guns", url: "https://redtide-stack.github.io/zeroOS-assets/stickmanguns.html", image: "https://cdn.jsdelivr.net/gh/gn-math/covers@main/578.png" },
      { name: "FNAW", url: "https://redtide-stack.github.io/zeroOS-assets/fnaw.html", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ-qF61UgY3rRmT5ejyAOvstSSCpMcExkC5dQ&s" },
    ],
    apps: [
      { name: "Browser", url: "https://redtide-stack.github.io/zeroOS-assets/p.html", image: "https://upload.wikimedia.org/wikipedia/commons/7/7e/Microsoft_Edge_logo_%282019%29.png" },
      { name: "Virtual Machine", url: "https://redtide-stack.github.io/zeroOS-assets/vm.html", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/02/Circle-icons-computer.svg/960px-Circle-icons-computer.svg.png" },
      { name: "Android Phone", url: "https://appetize.io/embed/xc1w6f1krd589zhp22a0mgftyw?autoplay=false&debug=true&device=pixel4&embed=true&launchUrl=exp%3A%2F%2Fexp.host%2F%40snack%2Fsdk.46.0.0-ghV0%21Qgb8N&scale=65&screenOnly=false&xDocMsg=true&xdocMsg=true&params=%7B&osVersion=11.0&deviceColor=black", image: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Android_robot.svg/960px-Android_robot.svg.png" },
      { name: "Soundboard", url: "https://myinstants.com", image: "https://play-lh.googleusercontent.com/v_5LsSgLe8lMcmmKc1uYMPkaOkM3JVVkl_IvQ8m9iim5Z8Pw80MgvMyA_zc2QvVs6zA" },
      { name: "Thirty Dollar Website", url: "https://thirtydollar.website", image: "https://symbl-cdn.com/i/webp/a1/bd21bc0d5c98bb21cbfe3ff871f2aa.webp" },
      { name: "NautilusOS", url: "https://redtide-stack.github.io/zeroOS-assets/nautilusos.html", image: "https://i.imgur.com/fH7uLLZ.png" },
      { name: "Windows 96", url: "https://windows96.net/", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRaOwEzAfw2sELsugCx71Wo_AwamTI-oJDOlA&s" },
      { name: "Unsafer Chatroom", url: "https://tlk.io/nebulo", image: "https://i.imgur.com/bbbuGgD.png" },
      { name: "Gauth Math", url: "https://gauthmath.com", image: "https://play-lh.googleusercontent.com/1CnI8ztueH5zyg2PLN1qEcPaL_j56Y48gEr2OKcD31ce799Qw91_U0QneDLmwYlCo3w" },
    ],
    dev: [
      { name: "Promptpad", url: "https://selenitebyplayer.artmuseum.org/resources/sppa/code/index.html", image: "https://i.imgur.com/bdty4lT.png" },
    ]
  };

  storeApps[type].forEach(app => {
    const div = document.createElement("div");
    div.className = "store-item";
    div.onclick = () => openApp(app.name, app.url);

    div.innerHTML = `
    <div class="pin-button" onclick="event.stopPropagation(); pinApp('${app.name}', '${app.url}', '${app.image}', this)">üñà</div>
      <img src="${app.image}">
      <strong>${app.name}</strong>
    `;

    grid.appendChild(div);
  });
}

/* ============================
   PINNING
   ============================ */

function pinApp(name, url, image, btn) {
  // Prevent duplicates
  if (pinnedApps.some(app => app.name === name)) return;

  const appData = { name, url, image };
  pinnedApps.push(appData);

  // Save to localStorage
  localStorage.setItem("zeroos_pinned_apps", JSON.stringify(pinnedApps));

  // Render immediately
  renderPinnedApps();

  // Visual feedback on pin button
  if (btn) {
    btn.style.background = "rgba(255, 0, 0, 0.8)";
  }
}

 function changeTabFavicon(iconUrl) {
     var link = document.querySelector("link[rel~='icon']");
     if (!link) {
     link = document.createElement('link');
     link.rel = 'icon';
     document.getElementsByTagName('head')[0].appendChild(link);
     }
     link.href = iconUrl;
     localStorage.setItem("tabIcon", iconUrl);
     }

     
     /* ============================
          START MENU BUTTONS
   ============================ */

//  function AboutBlank() {
//      alert('After you get redirected, close all windows and reopen them or else some functions will break like moving the window, maximizing, and completely breaks microsoft store, every app you pin also breaks, working on a fix but for now youll have to deal with my dumbass coding');
//      var win = window.open('');
//      win.document.open();
//      win.document.write(document.documentElement.outerHTML);
//      win.document.title = "about:blank";
//      win.document.close();
//      window.parent.window.location.replace('https://classroom.google.com/')
// }; OLD SCRIPT -MY DUMBASS CODING

function AboutBlank() {
    var win = window.open('about:blank', '_blank');
    if (!win) {
        alert("Pop-up blocked! Please allow pop-ups for this site.");
        return;
    }

    win.document.title = "zeroOS";

    var iframe = win.document.createElement('iframe');
    iframe.src = window.location.href; 
    iframe.style.position = "fixed";
    iframe.style.top = "0";
    iframe.style.left = "0";
    iframe.style.width = "100vw";
    iframe.style.height = "100vh";
    iframe.style.border = "none";
    iframe.style.margin = "0";
    iframe.style.padding = "0";
    iframe.style.overflow = "hidden";

    win.document.body.appendChild(iframe);
    win.document.body.style.margin = "0";

    window.location.replace('https://classroom.google.com');
}


function tabCloak() {
     var tabTitle = "Student Profile | Home | Infinite Campus";
     var tabIcon = "https://oakgroveca.infinitecampus.org/campus/nav-wrapper/assets/icons/favicon-32x32.png";
     document.title = tabTitle;
     changeTabFavicon(tabIcon);
     localStorage.setItem("tabName", tabTitle);
     localStorage.setItem("tabIcon", tabIcon);
};


/* ============================
   EVENT BINDINGS
   ============================ */

document.getElementById("taskbar-store-btn").addEventListener("click", openStore);


      
renderPinnedApps();
</script>


<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"94c79d4d951745d085049dd7f2bbd8f8","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"94c79d4d951745d085049dd7f2bbd8f8","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>   
